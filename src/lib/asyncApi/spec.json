{
  "asyncapi": "2.5.0",
  "info": {
    "title": "quizzes-game-io-backend",
    "description": "The Quizzes Game IO Backend Async API<br>\n이벤트 명은 {{scope}}.{{resource}}.{{action}}으로 규칙<br>\naction은 created, changed, deleted 3가지만 사용.(추후 새로운 액션 정의가 필요하다면 설계 추가)<br>\nex) lobby.game_room.changed<br>\n이벤트 페이로드의 action은 세부 액션임\n        ",
    "version": "0.1",
    "contact": {}
  },
  "tags": [],
  "servers": {},
  "components": {
    "schemas": {
      "GameRoomCreatedSocketEventAction": {
        "type": "string",
        "enum": ["created"]
      },
      "GameRoomStatus": {
        "type": "string",
        "enum": ["waiting", "starting", "inProgress", "finished", "paused"]
      },
      "GameRoomVisibility": {
        "type": "string",
        "enum": ["public", "private", "hidden"]
      },
      "GameRoomMemberRole": {
        "type": "string",
        "enum": ["host", "player"]
      },
      "GameRoomMemberSocketEventDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "accountId": {
            "type": "string"
          },
          "role": {
            "title": "GameRoomMemberRole",
            "allOf": [
              {
                "$ref": "#/components/schemas/GameRoomMemberRole"
              }
            ]
          },
          "nickname": {
            "type": "string"
          }
        },
        "required": ["id", "accountId", "role", "nickname"]
      },
      "GameRoomSocketEventDto": {
        "type": "object",
        "properties": {
          "gameRoomId": {
            "type": "string"
          },
          "status": {
            "title": "GameRoomStatus",
            "allOf": [
              {
                "$ref": "#/components/schemas/GameRoomStatus"
              }
            ]
          },
          "visibility": {
            "title": "GameRoomVisibility",
            "allOf": [
              {
                "$ref": "#/components/schemas/GameRoomVisibility"
              }
            ]
          },
          "title": {
            "type": "string"
          },
          "maxPlayers": {
            "type": "number"
          },
          "currentMembersCount": {
            "type": "number"
          },
          "quizTimeLimitInSeconds": {
            "type": "number"
          },
          "members": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/GameRoomMemberSocketEventDto"
            }
          },
          "quizzesCount": {
            "type": "number"
          }
        },
        "required": [
          "gameRoomId",
          "status",
          "visibility",
          "title",
          "maxPlayers",
          "currentMembersCount",
          "quizTimeLimitInSeconds",
          "members",
          "quizzesCount"
        ]
      },
      "LobbyGameRoomCreatedSocketEvent": {
        "type": "object",
        "properties": {
          "action": {
            "title": "GameRoomCreatedSocketEventAction",
            "allOf": [
              {
                "$ref": "#/components/schemas/GameRoomCreatedSocketEventAction"
              }
            ]
          },
          "eventName": {
            "type": "string",
            "example": "lobby.game_room.created"
          },
          "timestamp": {
            "format": "date-time",
            "type": "string"
          },
          "body": {
            "$ref": "#/components/schemas/GameRoomSocketEventDto"
          },
          "meta": {
            "type": "object"
          }
        },
        "required": ["action", "eventName", "timestamp", "body", "meta"]
      },
      "GameRoomChangedSocketEventAction": {
        "type": "string",
        "enum": [
          "member_joined",
          "member_left",
          "member_role_changed",
          "game_starting"
        ]
      },
      "LobbyGameRoomChangedSocketEvent": {
        "type": "object",
        "properties": {
          "action": {
            "title": "GameRoomChangedSocketEventAction",
            "allOf": [
              {
                "$ref": "#/components/schemas/GameRoomChangedSocketEventAction"
              }
            ]
          },
          "eventName": {
            "type": "string",
            "example": "lobby.game_room.changed"
          },
          "timestamp": {
            "format": "date-time",
            "type": "string"
          },
          "body": {
            "$ref": "#/components/schemas/GameRoomSocketEventDto"
          },
          "meta": {
            "type": "object"
          }
        },
        "required": ["action", "eventName", "timestamp", "body", "meta"]
      },
      "GameRoomDeletedSocketEventAction": {
        "type": "string",
        "enum": ["closed"]
      },
      "GameRoomIdentifierSocketEventDto": {
        "type": "object",
        "properties": {
          "gameRoomId": {
            "type": "string"
          }
        },
        "required": ["gameRoomId"]
      },
      "LobbyGameRoomDeletedSocketEvent": {
        "type": "object",
        "properties": {
          "action": {
            "title": "GameRoomDeletedSocketEventAction",
            "allOf": [
              {
                "$ref": "#/components/schemas/GameRoomDeletedSocketEventAction"
              }
            ]
          },
          "eventName": {
            "type": "string",
            "example": "lobby.game_room.deleted"
          },
          "timestamp": {
            "format": "date-time",
            "type": "string"
          },
          "body": {
            "$ref": "#/components/schemas/GameRoomIdentifierSocketEventDto"
          },
          "meta": {
            "type": "object"
          }
        },
        "required": ["action", "eventName", "timestamp", "body", "meta"]
      },
      "GameRoomChangedSocketEvent": {
        "type": "object",
        "properties": {
          "action": {
            "title": "GameRoomChangedSocketEventAction",
            "allOf": [
              {
                "$ref": "#/components/schemas/GameRoomChangedSocketEventAction"
              }
            ]
          },
          "eventName": {
            "type": "string",
            "example": "game_room.game_room.changed"
          },
          "timestamp": {
            "format": "date-time",
            "type": "string"
          },
          "body": {
            "$ref": "#/components/schemas/GameRoomSocketEventDto"
          },
          "meta": {
            "type": "object"
          }
        },
        "required": ["action", "eventName", "timestamp", "body", "meta"]
      },
      "AccountChangedSocketEventAction": {
        "type": "string",
        "enum": ["entered"]
      },
      "AccountSocketEventDto": {
        "type": "object",
        "properties": {
          "accountId": {
            "type": "string"
          },
          "nickname": {
            "type": "string"
          }
        },
        "required": ["accountId", "nickname"]
      },
      "LobbyAccountChangedSocketEvent": {
        "type": "object",
        "properties": {
          "action": {
            "title": "AccountChangedSocketEventAction",
            "allOf": [
              {
                "$ref": "#/components/schemas/AccountChangedSocketEventAction"
              }
            ]
          },
          "eventName": {
            "type": "string",
            "example": "lobby.account.changed"
          },
          "timestamp": {
            "format": "date-time",
            "type": "string"
          },
          "body": {
            "$ref": "#/components/schemas/AccountSocketEventDto"
          },
          "meta": {
            "type": "object"
          }
        },
        "required": ["action", "eventName", "timestamp", "body", "meta"]
      },
      "ActiveAccountChangedSocketEventAction": {
        "type": "string",
        "enum": ["incr"]
      },
      "ActiveAccountSocketEventDto": {
        "type": "object",
        "properties": {
          "currentActiveAccountsCount": {
            "type": "number"
          }
        },
        "required": ["currentActiveAccountsCount"]
      },
      "LobbyActiveAccountChangedSocketEvent": {
        "type": "object",
        "properties": {
          "action": {
            "title": "ActiveAccountChangedSocketEventAction",
            "allOf": [
              {
                "$ref": "#/components/schemas/ActiveAccountChangedSocketEventAction"
              }
            ]
          },
          "eventName": {
            "type": "string",
            "example": "lobby.active_account.changed"
          },
          "timestamp": {
            "format": "date-time",
            "type": "string"
          },
          "body": {
            "$ref": "#/components/schemas/ActiveAccountSocketEventDto"
          },
          "meta": {
            "type": "object"
          }
        },
        "required": ["action", "eventName", "timestamp", "body", "meta"]
      }
    }
  },
  "defaultContentType": "application/json",
  "channels": {
    "lobby.game_room.created": {
      "publish": {
        "tags": [
          {
            "name": "lobby"
          }
        ],
        "description": "게임방이 생성됨",
        "message": {
          "payload": {
            "$ref": "#/components/schemas/LobbyGameRoomCreatedSocketEvent"
          },
          "name": "SocketEventPublisher#_lobbyGameRoomCreatedSocketEvent"
        }
      }
    },
    "lobby.game_room.changed": {
      "publish": {
        "tags": [
          {
            "name": "lobby"
          }
        ],
        "description": "게임방의 상태 변경",
        "message": {
          "payload": {
            "$ref": "#/components/schemas/LobbyGameRoomChangedSocketEvent"
          },
          "name": "SocketEventPublisher#_lobbyGameRoomChangedSocketEvent"
        }
      }
    },
    "lobby.game_room.deleted": {
      "publish": {
        "tags": [
          {
            "name": "lobby"
          }
        ],
        "description": "게임방이 폐쇄됨",
        "message": {
          "payload": {
            "$ref": "#/components/schemas/LobbyGameRoomDeletedSocketEvent"
          },
          "name": "SocketEventPublisher#_lobbyGameRoomDeletedSocketEvent"
        }
      }
    },
    "game_room.game_room.changed": {
      "publish": {
        "tags": [
          {
            "name": "game_room"
          }
        ],
        "description": "게임방의 상태 변경",
        "message": {
          "payload": {
            "$ref": "#/components/schemas/GameRoomChangedSocketEvent"
          },
          "name": "SocketEventPublisher#_gameRoomChangedSocketEvent"
        }
      }
    },
    "lobby.account.changed": {
      "publish": {
        "tags": [
          {
            "name": "lobby"
          }
        ],
        "description": "유저가 서비스에 접속",
        "message": {
          "payload": {
            "$ref": "#/components/schemas/LobbyAccountChangedSocketEvent"
          },
          "name": "SocketEventPublisher#_lobbyAccountChangedSocketEvent"
        }
      }
    },
    "lobby.active_account.changed": {
      "publish": {
        "tags": [
          {
            "name": "lobby"
          }
        ],
        "description": "유저가 서비스에 접속",
        "message": {
          "payload": {
            "$ref": "#/components/schemas/LobbyActiveAccountChangedSocketEvent"
          },
          "name": "SocketEventPublisher#_lobbyActiveAccountChangedSocketEvent"
        }
      }
    }
  }
}
