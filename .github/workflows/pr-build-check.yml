name: PR Build Check

on:
  pull_request:
    branches:
      - main
      - develop
    types: [opened, synchronize, reopened]

jobs:
  build:
    name: Build and Lint Check
    uses: ./.github/workflows/shared/build.yml
    with:
      node-version: '18.x,20.x' # 매트릭스 빌드용
      upload-artifacts: false
      run-lint: true
      fail-fast: false # PR에서는 모든 Node 버전 테스트

  build-status:
    name: Build Status Check
    runs-on: ubuntu-latest
    needs: build
    if: always()

    steps:
      - name: Check build result
        run: |
          if [ "${{ needs.build.outputs.build-status }}" = "success" ]; then
            echo "✅ All builds passed!"
            echo "🎉 PR is ready for review"
          else
            echo "❌ Build failed!"
            echo "🔧 Please fix the build issues before merging"
            exit 1
          fi
